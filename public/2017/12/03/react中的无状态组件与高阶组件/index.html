<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="谦逊执着，自由无畏，君子知命不惧，日日自新。"><title>react中的无状态组件与高阶组件 | 信达的博客</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/normalize/7.0.0/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/1.0.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/1.0.0/grids-responsive-min.css"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">react中的无状态组件与高阶组件</h1><a id="logo" href="/.">信达的博客</a><p class="description">谦逊执着，自由无畏，君子知命不惧，日日自新。</p></div><div id="nav-menu"><a href="/." class="current"><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a><a href="/atom.xml"><i class="fa fa-rss"> 订阅</i></a></div></div><div id="layout" class="pure-g"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">react中的无状态组件与高阶组件</h1><div class="post-meta">Dec 3, 2017<span> | </span><span class="category"><a href="/categories/JavaScript/">JavaScript</a></span></div><div class="post-content"><p>react组件我们非常熟悉，平时开发过程中一直使用，在react开发过程中，有两种比较特殊的组件，分别为无状态组件和高阶组件，今天一起来理解一下他们。</p>
<a id="more"></a>
<h3 id="无状态组件"><a href="#无状态组件" class="headerlink" title="无状态组件"></a>无状态组件</h3><p>无状态组件是从react 0.14版本开始出现的，他可以用来创建纯展示型的组件，这种组件只负责根据传入的props进行展示，下面是它的基本形式：</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">HelloComponent</span>(<span class="params">props</span>)</span>&#123;</div><div class="line">    <span class="keyword">return</span> (</div><div class="line">    	&lt;div&gt;&#123;props.name&#125;&lt;<span class="regexp">/div&gt;</span></div><div class="line"><span class="regexp">    )</span></div><div class="line"><span class="regexp">&#125;</span></div><div class="line"><span class="regexp"></span></div><div class="line"><span class="regexp">ReactDOM.render(&lt;HelloComponent name='xinda' /</span>&gt;,element)</div></pre></td></tr></table></figure>
<p>无状态组件的一些特点如下</p>
<ul>
<li>组件不会被实例化，被精简成了render()方法的一个函数来实现的，从而性能能够有所提升。</li>
<li>组件不能访问this对象，无状态组件由于没有实例化过程，因此无法访问this中的对象。</li>
<li>组件没有声明周期的方法。</li>
<li>无状态组件只能访问输入的props，同样的props会得到同样的渲染结果，不会有副作用。</li>
</ul>
<p>无状态组件有着良好的阅读型，是用来分割复杂组件的利器，所以只要有可能，应该尽量使用无状态组件。</p>
<h3 id="高阶组件"><a href="#高阶组件" class="headerlink" title="高阶组件"></a>高阶组件</h3><p>高阶组件就是一个没有副作用的纯函数，它接受一个组件，返回一个新组件。</p>
<p>假设有如下两个组件：</p>
<h5 id="组件1：welcome组件"><a href="#组件1：welcome组件" class="headerlink" title="组件1：welcome组件"></a>组件1：welcome组件</h5><figure class="highlight jsx"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> React, &#123;Component&#125; <span class="keyword">from</span> <span class="string">'react'</span>;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Welcome</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</div><div class="line">  <span class="keyword">constructor</span>(props)&#123;</div><div class="line">    <span class="keyword">super</span>(props);</div><div class="line">    <span class="keyword">this</span>.state = &#123;</div><div class="line">      username : <span class="string">''</span></div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">  </div><div class="line">  componentWillMount()&#123;</div><div class="line">    <span class="keyword">let</span> username = localStorage.getItem(<span class="string">'username'</span>);</div><div class="line">    <span class="keyword">this</span>.setState(&#123;</div><div class="line">      username:username</div><div class="line">    &#125;)</div><div class="line">  &#125;</div><div class="line">  </div><div class="line">  render()&#123;</div><div class="line">    <span class="keyword">return</span> (</div><div class="line">    	&lt;div&gt;Welcome , &#123;<span class="keyword">this</span>.state.username&#125;&lt;<span class="regexp">/div&gt;</span></div><div class="line"><span class="regexp">    )</span></div><div class="line"><span class="regexp">  &#125;</span></div><div class="line"><span class="regexp">  </span></div><div class="line"><span class="regexp">&#125;</span></div></pre></td></tr></table></figure>
<h5 id="组件2：goodbey组件"><a href="#组件2：goodbey组件" class="headerlink" title="组件2：goodbey组件"></a>组件2：goodbey组件</h5><figure class="highlight jsx"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> React, &#123;Component&#125; <span class="keyword">from</span> <span class="string">'react'</span>;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Goodbey</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</div><div class="line">  <span class="keyword">constructor</span>(props)&#123;</div><div class="line">    <span class="keyword">super</span>(props);</div><div class="line">    <span class="keyword">this</span>.state = &#123;</div><div class="line">      username : <span class="string">''</span></div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">  </div><div class="line">  componentWillMount()&#123;</div><div class="line">    <span class="keyword">let</span> username = localStorage.getItem(<span class="string">'username'</span>);</div><div class="line">    <span class="keyword">this</span>.setState(&#123;</div><div class="line">      username:username</div><div class="line">    &#125;)</div><div class="line">  &#125;</div><div class="line">  </div><div class="line">  render()&#123;</div><div class="line">    <span class="keyword">return</span> (</div><div class="line">    	&lt;div&gt;Goodbey , &#123;<span class="keyword">this</span>.state.username&#125;&lt;<span class="regexp">/div&gt;</span></div><div class="line"><span class="regexp">    )</span></div><div class="line"><span class="regexp">  &#125;</span></div><div class="line"><span class="regexp">  </span></div><div class="line"><span class="regexp">&#125;</span></div></pre></td></tr></table></figure>
<p>可以看到，上面的两个组件中从localStorage获取username，再将username保存到state中，这两个步骤代码是重复的，既会造成代码的冗余，也会造成在调整username时需要对两个组件的代码进行修改，因此我们需要一种方法，能够抽取这部分代码，让组件更加简洁和易于维护，高阶组件可以解决这个问题，示例代码如下：</p>
<h5 id="高阶组件-1"><a href="#高阶组件-1" class="headerlink" title="高阶组件"></a>高阶组件</h5><figure class="highlight jsx"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> (wrapComponent) =&gt; &#123;</div><div class="line">  <span class="class"><span class="keyword">class</span> <span class="title">NewComponent</span> <span class="keyword">extends</span> <span class="title">Component</span></span>&#123;</div><div class="line">    <span class="keyword">constructor</span>()&#123;</div><div class="line">      <span class="keyword">super</span>();</div><div class="line">      <span class="keyword">this</span>.state = &#123;</div><div class="line">        username : <span class="string">''</span></div><div class="line">      &#125;</div><div class="line">    &#125;</div><div class="line">    componentWillMount()&#123;</div><div class="line">      <span class="keyword">let</span> username = localStorage.getItem(<span class="string">'username'</span>);</div><div class="line">      <span class="keyword">this</span>.setState(&#123;</div><div class="line">        username:username</div><div class="line">      &#125;)</div><div class="line">    &#125;</div><div class="line">    render()&#123;</div><div class="line">      <span class="keyword">return</span> &lt;wrapComponent username=&#123;this.state.username&#125; /&gt;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">  &#125;</div><div class="line">  return NewComponent;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>高阶组件就是一个函数，他从参数wrapComponent接收了一个组件，并生成了一个新的组件，新组件通过内部逻辑将username作为props传递给了传入组件，并将组件返回，有了这个高阶组件后，之前的welcome组件和goodbey组件就可以简化了</p>
<h5 id="welcome组件"><a href="#welcome组件" class="headerlink" title="welcome组件"></a>welcome组件</h5><figure class="highlight jsx"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> React , &#123;Component&#125; <span class="keyword">from</span> <span class="string">'react'</span>;</div><div class="line"><span class="keyword">import</span> wrapWithUsername <span class="keyword">from</span> <span class="string">'wrapWithUsername'</span>;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Welcome</span> <span class="title">from</span> <span class="title">Component</span> </span>&#123;</div><div class="line">  render()&#123;</div><div class="line">    <span class="keyword">return</span> (</div><div class="line">    	&lt;div&gt;welcome,&#123;<span class="keyword">this</span>.props.username&#125;&lt;<span class="regexp">/div&gt;</span></div><div class="line"><span class="regexp">    )</span></div><div class="line"><span class="regexp">  &#125;</span></div><div class="line"><span class="regexp">&#125;</span></div><div class="line"><span class="regexp"></span></div><div class="line"><span class="regexp">Welcome = wrapWithUsername(Welcome);</span></div><div class="line"><span class="regexp">export default Welcome;</span></div></pre></td></tr></table></figure>
<h5 id="goodbey组件"><a href="#goodbey组件" class="headerlink" title="goodbey组件"></a>goodbey组件</h5><figure class="highlight jsx"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> React , &#123;Component&#125; <span class="keyword">from</span> <span class="string">'react'</span>;</div><div class="line"><span class="keyword">import</span> wrapWithUsername <span class="keyword">from</span> <span class="string">'wrapWithUsername'</span>;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Goodbey</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</div><div class="line">  render()&#123;</div><div class="line">    <span class="keyword">return</span> (</div><div class="line">    	&lt;div&gt;goodbey,&#123;<span class="keyword">this</span>.props.username&#125;&lt;<span class="regexp">/div&gt;</span></div><div class="line"><span class="regexp">    )</span></div><div class="line"><span class="regexp">  &#125;</span></div><div class="line"><span class="regexp">&#125;</span></div><div class="line"><span class="regexp">Goodbey = wrapWithUsername(Goodbey);</span></div><div class="line"><span class="regexp">export default Goodbey;</span></div></pre></td></tr></table></figure>
<p>可以看到，经过抽取高阶组件，welcome组件和goodbey组件变的非常简洁，只需要从props直接取出username使用就可以了，而不需要去管高阶组件中username的获取逻辑，如果出现username获取逻辑的修改，我们只需要修改高阶组件中的逻辑就可以了，不需要去修改使用这个组件的其他组件，维护起来也比较方便。</p>
</div><script type="text/javascript" src="/js/share.js?v=0.0.0" async></script><a data-url="http://localhost:4000/2017/12/03/react中的无状态组件与高阶组件/" data-id="cjaqxwdyg000038oljniucbwq" data-qrcode="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAN4AAADeCAAAAAB3DOFrAAACxElEQVR42u3awY6jQAwE0Pz/T89KexppRVJlN2QPj9MoQ6AfB9op+/WKj5+/x++/rz75/fm/3726QnvHwwceHh7eaOlXR37Oe1K76PePqVgPHh4e3m28fCmzTWJ2l6srFI8VDw8P76u892Vx8sns+rOHhYeHh/e/8XJqHlu0JTUeHh7ed3mzcrb97ixoeChrwcPDw+ty17oB9t2/b+/v4eHh4Y266rPodjYcMBtQ+LBaPDw8vBt4+5ZVXnAn19yUyMUvBjw8PLwFL/+pn7+a8+GqNrxoHyseHh7eHbxo3yjHBfaDXMmmkj8sPDw8vLO8/JU9G4pKCuJ2Q6r3PTw8PLyjvHbQqg1nZ0vMm151ewwPDw9vzdtHBpum1/vz298ElyU1Hh4e3lFe2yubUdv2WL555CEIHh4e3ilePcB0w+PIz0kGFy6zFjw8PLxDvLzh1J6TRxjtfet8BQ8PD+8o71Qsm7z097FsHvh+6O/h4eHhrXltTJCX3e0VNptTlFLj4eHh3cAb5r6Lo91s6pkyPDw8vNt4bTt/E7/uW2LR+Xh4eHiP8Nowog1wn2mnvdqb4eHh4ZW8tmhuw98k3p1tTgcWioeHhzdKD/Igtf1vfq/9CAIeHh7eM7y85G2bUpvieBaCXIYReHh4eEd5bRG8aUcVIUK5aUXFOh4eHt4hXnvLHDYrtVvShyoaDw8P72Ze3r7KvzUrkWdDCR8aYHh4eHiHeG1jafaybgOIWUOuDiPw8PDwRryf8tgMZrWhbbsx1N02PDw8vBFv9vKdlcLJNtBGw6thLDw8PLwFbxMEzEYEcsysYYaHh4f3DG9fKLcN/tlYVZ3Q4uHh4X2VFzXs4+CgDX8P59N4eHh4D/LaQDZ/HJsBhQ/zEXh4eHg38DZhxKyhtWnI5T8A8PDw8O7gbQabZq/+NrptQ+dVfw8PDw/v3Ur+AAFZX/QYZoGbAAAAAElFTkSuQmCC" class="article-share-link">分享</a><div class="tags"><a href="/tags/react/">react</a></div><div class="post-nav"><a href="/2017/12/03/子元素在父元素中垂直水平居中问题/" class="next">子元素在父元素中垂直水平居中问题</a></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><form action="//www.google.com/search" method="get" accept-charset="utf-8" target="_blank" class="search-form"><input type="text" name="q" maxlength="20" placeholder="Search"/><input type="hidden" name="sitesearch" value="http://localhost:4000"/></form></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/JavaScript/">JavaScript</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/html-css/">html/css</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/技术笔记本/">技术笔记本</a><span class="category-list-count">3</span></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> 标签</i></div><div class="tagcloud"><a href="/tags/HTTP/" style="font-size: 15px;">HTTP</a> <a href="/tags/TCP-IP/" style="font-size: 15px;">TCP/IP</a> <a href="/tags/JS插件/" style="font-size: 15px;">JS插件</a> <a href="/tags/视频播放器/" style="font-size: 15px;">视频播放器</a> <a href="/tags/CSS/" style="font-size: 15px;">CSS</a> <a href="/tags/react/" style="font-size: 15px;">react</a></div></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2017 <a href="/." rel="nofollow">信达的博客.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a id="rocket" href="#top" class="show"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//cdn.bootcss.com/fancybox/3.1.20/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/fancybox/3.1.20/jquery.fancybox.min.css"><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>